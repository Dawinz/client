(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6924],{56715:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/author/posts/[slug]",function(){return n(7370)}])},88446:function(e,t,n){"use strict";n.d(t,{Z:function(){return O}});var r=n(34051),o=n.n(r),i=n(85893),a=n(67294),s=n(97183),l=n(68157),u=n(41664),c=n(61715),d=n(34146),f=n(42952),h=n(57184),p=n(88916),v=n(71255),x=n(87547),m=l.Z.SubMenu,j=s.Z.Sider,g=function(){var e,t,n=(0,a.useContext)(d.V),r=n[0],o=(n[1],(0,a.useState)(!1)),s=o[0],g=o[1],y=(0,a.useState)(""),w=y[0],b=y[1],Z=(0,c.Lm)();(0,a.useEffect)((function(){b(window.location.pathname)}),[window.location.pathname]),(0,a.useEffect)((function(){Z<800?g(!0):Z>800&&g(!1)}),[Z<800]);var S=function(e){return"".concat(w===e&&"active")};return(0,i.jsx)(j,{collapsible:!0,collapsed:s,onCollapse:function(){return g(!s)},children:(0,i.jsxs)(l.Z,{defaultOpenKeys:["2","6","10"],mode:"inline",inlineCollapsed:s,children:[(0,i.jsx)(l.Z.Item,{icon:(0,i.jsx)(f.Z,{}),children:(0,i.jsx)(u.default,{href:"/author",children:(0,i.jsx)("a",{className:S("/author"),children:"Dashboard"})})},"1"),(0,i.jsxs)(m,{icon:(0,i.jsx)(h.Z,{}),title:"Posts",children:[(0,i.jsx)(l.Z.Item,{children:(0,i.jsx)(u.default,{href:"/author/posts",children:(0,i.jsx)("a",{className:S("/author/posts"),children:"All Posts"})})},"3"),(0,i.jsx)(l.Z.Item,{children:(0,i.jsx)(u.default,{href:"/author/posts/new",children:(0,i.jsx)("a",{className:S("/author/posts/new"),children:"Add New"})})},"4")]},"2"),(0,i.jsxs)(m,{icon:(0,i.jsx)(p.Z,{}),title:"Media",children:[(0,i.jsx)(l.Z.Item,{children:(0,i.jsx)(u.default,{href:"/author/media/library",children:(0,i.jsx)("a",{className:S("/author/media/library"),children:"Library"})})},"7"),(0,i.jsx)(l.Z.Item,{children:(0,i.jsx)(u.default,{href:"/author/media/new",children:(0,i.jsx)("a",{className:S("/author/media/new"),children:"Add New"})})},"8")]},"6"),(0,i.jsx)(l.Z.Item,{icon:(0,i.jsx)(v.Z,{}),children:(0,i.jsx)(u.default,{href:"/author/comments",children:(0,i.jsx)("a",{className:S("/author/comments"),children:"Comments"})})},"9"),(0,i.jsx)(l.Z.Item,{icon:(0,i.jsx)(x.Z,{}),children:(0,i.jsx)(u.default,{href:"/author/".concat(null===r||void 0===r||null===(e=r.user)||void 0===e?void 0:e._id),children:(0,i.jsx)("a",{className:S("/author/".concat(null===r||void 0===r||null===(t=r.user)||void 0===t?void 0:t._id)),children:"Profile"})})},"13")]})})},y=n(11163),w=n(9669),b=n.n(w),Z=n(27161);function S(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(r,o)}var k=s.Z.Content;var O=function(e){var t=e.children,n=(0,a.useContext)(d.V),r=n[0],l=(n[1],(0,a.useState)(!0)),u=l[0],c=l[1],f=(0,y.useRouter)();(0,a.useEffect)((function(){(null===r||void 0===r?void 0:r.token)&&h()}),[null===r||void 0===r?void 0:r.token]);var h=function(){var e,t=(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b().get("/current-author");case 3:e.sent.data,c(!1),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),f.push("/");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){S(i,r,o,a,s,"next",e)}function s(e){S(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}();return u?(0,i.jsx)(Z.Z,{}):(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(g,{}),(0,i.jsx)(s.Z,{children:(0,i.jsx)(k,{style:{padding:"10px"},children:t})})]})}},33875:function(e,t,n){"use strict";var r=n(34051),o=n.n(r),i=n(85893),a=n(67294),s=n(9835),l=n(71230),u=n(15746),c=n(79531),d=n(71577),f=n(67691),h=n(14538),p=n(28819),v=n.n(p),x=n(5162),m=n(9669),j=n.n(m),g=n(45771),y=n(74931),w=n(11163),b=n(88484),Z=n(16853),S=n(76329);function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){O(i,r,o,a,s,"next",e)}function s(e){O(i,r,o,a,s,"throw",e)}a(void 0)}))}}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){P(e,t,n[t])}))}return e}function I(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var N=s.Z.Option;t.Z=function(e){var t,n,r=e.page,p=void 0===r?"admin":r,m=(0,a.useContext)(x.N),k=m[0],O=(m[1],(0,a.useContext)(S.Y)),P=O[0],E=O[1],A=(0,a.useState)(""),M=A[0],T=A[1],V=(0,a.useState)(""),D=V[0],L=V[1],R=(0,a.useState)(""),q=R[0],F=R[1],G=(0,a.useState)([]),J=G[0],X=G[1],z=(0,a.useState)([]),K=z[0],U=z[1],Y=(0,a.useState)({}),$=Y[0],B=Y[1],H=(0,a.useState)(!1),Q=H[0],W=H[1],ee=(0,a.useState)(!0),te=ee[0],ne=ee[1],re=(0,w.useRouter)();(0,a.useEffect)((function(){oe()}),[null===re||void 0===re||null===(t=re.query)||void 0===t?void 0:t.slug]),(0,a.useEffect)((function(){ie()}),[]);var oe=function(){var e=C(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j().get("/post/".concat(re.query.slug));case 3:t=e.sent.data,console.log("GOT POST FOR EDIT",t),L(t.post.title),F(t.post.content),B(t.post.featuredImage),T(t._id),n=[],t.post.categories.map((function(e){return n.push(e.name)})),X(n),ne(!1),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=C(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j().get("/categories");case 3:t=e.sent.data,U(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=C(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,ne(!0),e.next=5,j().put("/edit-post/".concat(M),{title:D,content:q,categories:J,featuredImage:(null===P||void 0===P||null===(t=P.selected)||void 0===t?void 0:t._id)?null===P||void 0===P||null===(n=P.selected)||void 0===n?void 0:n._id:(null===$||void 0===$?void 0:$._id)?$._id:void 0});case 5:(null===(r=e.sent.data)||void 0===r?void 0:r.error)?(y.Am.error(null===r||void 0===r?void 0:r.error),ne(!1)):(y.Am.success("Post updated successfully"),E(_({},P,{selected:null})),re.push("/".concat(p,"/posts"))),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),y.Am.error("Post create failed. Try again."),ne(!1);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return(0,i.jsxs)(l.Z,{children:[(0,i.jsxs)(u.Z,{span:14,offset:1,children:[(0,i.jsx)("h1",{children:"Edit post"}),(0,i.jsx)(c.Z,{size:"large",value:D,placeholder:"Give your post a title",onChange:function(e){L(e.target.value),localStorage.setItem("post-title",JSON.stringify(e.target.value))}}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),te?(0,i.jsx)("div",{children:"Loading..."}):(0,i.jsx)("div",{className:"editor-scroll",children:(0,i.jsx)(v(),{dark:"light"!==k,defaultValue:q,onChange:function(e){F(e()),localStorage.setItem("post-content",JSON.stringify(e()))},uploadImage:g.I})}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{})]}),(0,i.jsxs)(u.Z,{span:6,offset:1,children:[(0,i.jsx)(d.Z,{style:{margin:"10px 0px 10px 0px",width:"100%"},onClick:function(){return W(!0)},children:"Preview"}),(0,i.jsxs)(d.Z,{style:{margin:"10px 0px 10px 0px",width:"100%"},onClick:function(){return E(_({},P,{showMediaModal:!0}))},children:[(0,i.jsx)(b.Z,{})," Featured Image"]}),(0,i.jsx)("h4",{children:"Categories"}),(0,i.jsx)(s.Z,{mode:"multiple",allowClear:!0,placeholder:"Select categories",style:{width:"100%"},onChange:function(e){return X(e)},value:I(J),children:K.map((function(e){return(0,i.jsx)(N,{children:e.name},e.name)}))}),(null===P||void 0===P?void 0:P.selected)?(0,i.jsx)("div",{style:{marginTop:"15px"},children:(0,i.jsx)(f.Z,{width:"100%",src:null===P||void 0===P||null===(n=P.selected)||void 0===n?void 0:n.url})}):(null===$||void 0===$?void 0:$.url)?(0,i.jsx)("div",{style:{marginTop:"15px"},children:(0,i.jsx)(f.Z,{width:"100%",src:null===$||void 0===$?void 0:$.url})}):"",(0,i.jsx)(d.Z,{loading:te,style:{margin:"10px 0px 10px 0px",width:"100%"},type:"primary",onClick:ae,children:"Publish"})]}),(0,i.jsxs)(h.Z,{title:"Preview",centered:!0,visible:Q,onOk:function(){return W(!1)},onCancel:function(){return W(!1)},width:720,footer:null,children:[(0,i.jsx)("h1",{children:D}),(0,i.jsx)(v(),{dark:"light"!==k,defaultValue:q,readOnly:!0})]}),(0,i.jsx)(h.Z,{visible:P.showMediaModal,title:"Media",onOk:function(){return E(_({},P,{showMediaModal:!1}))},onCancel:function(){return E(_({},P,{showMediaModal:!1}))},width:720,footer:null,children:(0,i.jsx)(Z.Z,{})})]})}},7370:function(e,t,n){"use strict";n.r(t);var r=n(85893),o=n(88446),i=n(33875);t.default=function(){return(0,r.jsx)(o.Z,{children:(0,r.jsx)(i.Z,{page:"author"})})}}},function(e){e.O(0,[5453,7624,8773,8874,6994,9835,8231,7910,4209,4551,4687,301,8973,8819,7594,9774,2888,179],(function(){return t=56715,e(e.s=t);var t}));var t=e.O();_N_E=t}]);